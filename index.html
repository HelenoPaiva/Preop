<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Preoperative Evaluation / Avaliação Pré-operatória</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Custom CSS -->
  <link rel="stylesheet" href="css/app.css" />

  <meta name="description" content="Browser-based preoperative evaluation helper with structured risk scores and documentation export." />
</head>
<body class="bg-slate-950 text-slate-100 antialiased">
  <div class="min-h-screen flex flex-col">

    <!-- Top bar -->
    <header class="border-b border-slate-800/80 bg-slate-950/80 backdrop-blur">
      <div class="max-w-6xl mx-auto px-4 py-3 flex flex-wrap items-center justify-between gap-3">
        <div class="flex items-center gap-2">
          <div class="h-8 w-8 rounded-xl bg-emerald-500/20 border border-emerald-400/50 flex items-center justify-center text-emerald-300 font-semibold text-xs">
            PRE
          </div>
          <div>
            <h1 class="text-sm sm:text-base font-semibold tracking-tight">
              Preoperative Evaluation <span class="text-slate-400">/ Avaliação Pré-operatória</span>
            </h1>
            <p class="text-xs text-slate-400">
              Browser-based helper — all calculations run locally.
            </p>
          </div>
        </div>

        <div class="flex items-center gap-2 text-xs">
          <!-- Link para GitHub do projeto (ajuste o href) -->
          <a
            href="https://github.com/HelenoPaiva"
            target="_blank"
            rel="noopener noreferrer"
            class="inline-flex items-center gap-1 px-2.5 py-1 rounded-full border border-slate-700/80 bg-slate-900/70 hover:bg-slate-800/80 transition-colors"
          >
            <span class="i-mdi-github text-lg"></span>
            <span>GitHub repo</span>
          </a>
        </div>
      </div>
    </header>

    <!-- Main -->
    <main class="flex-1">
      <div class="max-w-6xl mx-auto px-4 py-6 md:py-8 grid gap-4 md:gap-6 lg:grid-cols-[minmax(0,2fr)_minmax(0,1.4fr)] items-start">

        <!-- LEFT: Inputs -->
        <section
          id="input-panel"
          class="rounded-2xl border border-slate-800/80 bg-slate-950/70 shadow-[0_18px_45px_rgba(15,23,42,0.85)] overflow-hidden"
        >
          <div class="border-b border-slate-800/80 px-4 py-3 flex items-center justify-between gap-3">
            <div>
              <h2 class="text-sm font-semibold tracking-tight">
                Patient & Surgery / Paciente & Cirurgia
              </h2>
              <p class="text-xs text-slate-400">
                Minimal structured input; no data is sent to a server.
              </p>
            </div>
            <button
              id="btn-reset"
              type="button"
              class="text-[11px] px-2.5 py-1 rounded-full border border-slate-700/80 text-slate-300 hover:bg-slate-800/80 transition-colors"
            >
              Clear / Limpar
            </button>
          </div>

          <div class="p-4 md:p-5 space-y-4 text-sm">
            <!-- Patient core data -->
            <div class="grid md:grid-cols-3 gap-3">
              <div>
                <label for="patient-name" class="block text-xs font-medium text-slate-300 mb-1">
                  Name / Nome
                </label>
                <input
                  id="patient-name"
                  type="text"
                  class="app-input"
                  placeholder="Ex.: J.S.S."
                />
              </div>

              <div>
                <label for="patient-age" class="block text-xs font-medium text-slate-300 mb-1">
                  Age / Idade (anos)
                </label>
                <input
                  id="patient-age"
                  type="number"
                  min="0"
                  max="120"
                  class="app-input"
                  placeholder="45"
                />
              </div>

              <div>
                <label class="block text-xs font-medium text-slate-300 mb-1">
                  Sex / Sexo
                </label>
                <div class="inline-flex rounded-full bg-slate-900/80 border border-slate-700/80 p-0.5 text-xs">
                  <button
                    type="button"
                    data-sex="M"
                    class="sex-toggle app-chip app-chip-active rounded-full px-3 py-1"
                  >
                    M
                  </button>
                  <button
                    type="button"
                    data-sex="F"
                    class="sex-toggle app-chip rounded-full px-3 py-1"
                  >
                    F
                  </button>
                </div>
              </div>
            </div>

            <!-- Anthropometrics -->
            <div class="border border-slate-800/80 rounded-xl bg-slate-950/60 p-3 space-y-3">
              <div class="flex items-center justify-between gap-2">
                <h3 class="text-xs font-semibold text-slate-200">
                  Anthropometrics / Antropometria
                </h3>
                <span class="text-[10px] px-2 py-0.5 rounded-full border border-slate-700/80 text-slate-300 bg-slate-900/80">
                  Height, weight, BMI, IBW
                </span>
              </div>

              <div class="grid md:grid-cols-4 gap-3 items-end">
                <div>
                  <label for="height-cm" class="block text-xs font-medium text-slate-300 mb-1">
                    Height / Altura (cm)
                  </label>
                  <input
                    id="height-cm"
                    type="number"
                    inputmode="decimal"
                    class="app-input"
                    placeholder="170"
                  />
                  <p id="height-error" class="app-error mt-1 hidden"></p>
                </div>

                <div>
                  <label for="weight-kg" class="block text-xs font-medium text-slate-300 mb-1">
                    Weight / Peso (kg)
                  </label>
                  <input
                    id="weight-kg"
                    type="number"
                    inputmode="decimal"
                    class="app-input"
                    placeholder="90"
                  />
                  <p id="weight-error" class="app-error mt-1 hidden"></p>
                </div>

                <div>
                  <label class="block text-xs font-medium text-slate-300 mb-1">
                    BMI / IMC
                  </label>
                  <div class="app-output" id="bmi-display">
                    —
                  </div>
                </div>

                <div>
                  <label class="block text-xs font-medium text-slate-300 mb-1">
                    IBW (Devine)
                    <span
                      class="text-[10px] text-emerald-300 cursor-help"
                      data-tooltip="Uses Devine formula for Ideal Body Weight. IBW (kg) = 50 + 0.9 × (height in cm − 152) for men; 45.5 + 0.9 × (height in cm − 152) for women."
                    >
                      [?]
                    </span>
                  </label>
                  <div class="app-output" id="ibw-devine-display">
                    —
                  </div>
                </div>
              </div>
            </div>

            <!-- Surgery info -->
            <div class="border border-slate-800/80 rounded-xl bg-slate-950/60 p-3 space-y-3">
              <div class="flex items-center justify-between gap-2">
                <h3 class="text-xs font-semibold text-slate-200">
                  Surgery / Cirurgia
                </h3>
                <span class="text-[10px] text-slate-400">
                  Major fields only, detailed notes below
                </span>
              </div>

              <div class="grid md:grid-cols-2 gap-3">
                <div>
                  <label for="surgery-type" class="block text-xs font-medium text-slate-300 mb-1">
                    Type / Tipo
                  </label>
                  <input
                    id="surgery-type"
                    type="text"
                    class="app-input"
                    placeholder="Ex.: Sleeve gástrico, colecistectomia..."
                  />
                </div>
                <div>
                  <label for="asa-class" class="block text-xs font-medium text-slate-300 mb-1">
                    ASA Class / Classe ASA
                  </label>
                  <select id="asa-class" class="app-input">
                    <option value="">Selecione...</option>
                    <option value="I">ASA I</option>
                    <option value="II">ASA II</option>
                    <option value="III">ASA III</option>
                    <option value="IV">ASA IV</option>
                    <option value="V">ASA V</option>
                  </select>
                </div>
              </div>

              <div>
                <label for="notes" class="block text-xs font-medium text-slate-300 mb-1">
                  Notes / Observações relevantes
                </label>
                <textarea
                  id="notes"
                  rows="3"
                  class="app-input resize-y"
                  placeholder="Comorbidades relevantes, limitações de via aérea, anticoagulação, DPOC, história de eventos tromboembólicos..."
                ></textarea>
              </div>
            </div>

            <!-- Actions -->
            <div class="flex flex-wrap items-center justify-between gap-3 pt-1">
              <div class="text-[10px] text-slate-500">
                This tool does not replace clinical judgement. /
                Esta ferramenta não substitui o julgamento clínico.
              </div>
              <div class="flex flex-wrap gap-2">
                <button
                  id="btn-generate-summary"
                  type="button"
                  class="btn-primary"
                >
                  Generate summary / Gerar resumo
                </button>
                <button
                  id="btn-copy-summary"
                  type="button"
                  class="btn-secondary"
                >
                  Copy to clipboard / Copiar
                </button>
              </div>
            </div>
          </div>
        </section>

        <!-- RIGHT: Results -->
        <section
          id="output-panel"
          class="rounded-2xl border border-slate-800/80 bg-slate-950/70 shadow-[0_18px_45px_rgba(15,23,42,0.85)] flex flex-col overflow-hidden"
        >
          <div class="border-b border-slate-800/80 px-4 py-3 flex items-center justify-between">
            <div>
              <h2 class="text-sm font-semibold tracking-tight">
                Summary & Scores / Resumo & Escores
              </h2>
              <p class="text-xs text-slate-400">
                Auto-filled when you generate the summary.
              </p>
            </div>
          </div>

          <div class="flex-1 p-4 md:p-5 flex flex-col gap-4 text-sm">
            <!-- Quick indicators -->
            <div class="grid sm:grid-cols-3 gap-3">
              <div class="mini-card">
                <div class="mini-label">BMI / IMC</div>
                <div id="summary-bmi" class="mini-value">—</div>
                <div id="summary-bmi-tag" class="mini-tag">—</div>
              </div>
              <div class="mini-card">
                <div class="mini-label">ASA</div>
                <div id="summary-asa" class="mini-value">—</div>
                <div class="mini-tag">Physical status</div>
              </div>
              <div class="mini-card">
                <div class="mini-label">Risk comment</div>
                <div id="summary-risk" class="mini-value text-xs leading-snug">
                  —
                </div>
              </div>
            </div>

            <!-- Text summary -->
            <div class="flex-1 border border-slate-800/80 rounded-xl bg-slate-950/60 overflow-hidden flex flex-col">
              <div class="border-b border-slate-800/80 px-3 py-2 flex items-center justify-between text-[11px] text-slate-400">
                <span>Pre-op note (PT/EN) / Nota pré-operatória (PT/EN)</span>
                <span id="summary-length" class="text-[10px] text-slate-500">
                  0 chars
                </span>
              </div>
              <textarea
                id="summary-output"
                class="flex-1 bg-transparent text-xs md:text-[13px] text-slate-100 px-3 py-2 outline-none resize-none"
                spellcheck="false"
                placeholder="Click &quot;Generate summary&quot; to auto-fill a bilingual note you can paste into your clinical record..."
              ></textarea>
            </div>

            <div class="text-[10px] text-slate-500">
              No patient identifiers are stored or transmitted; everything runs in your browser.
            </div>
          </div>
        </section>
      </div>
    </main>

    <!-- Toast container -->
    <div id="toast-container" class="fixed bottom-4 right-4 z-40 space-y-2"></div>
  </div>

  <!-- Main JS (modules) -->
  <script type="module" src="js/app.js"></script>
</body>
</html>
